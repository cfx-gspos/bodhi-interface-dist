(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[728],{4474:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/message",function(){return s(28949)}])},28949:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return F}});var r=s(85893),n=s(61730),i=s(5616),o=s(15861),a=s(67294),d=s(67952),c=s(31065),l=s(74187),u=s(88144),h=s(30202),p=s(59289),x=s(27037),m=s(7506),g=s(24139),y=class extends m.l{#t;#e=void 0;#s;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,g.VS)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,g.Ym)(e.mutationKey)!==(0,g.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#n(),this.#i(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#i()}mutate(t,e){return this.#r=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#n(){let t=this.#s?.state??(0,p.R)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#i(t){x.V.batch(()=>{if(this.#r&&this.hasListeners()){let e=this.#e.variables,s=this.#e.context;t?.type==="success"?(this.#r.onSuccess?.(t.data,e,s),this.#r.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#r.onError?.(t.error,e,s),this.#r.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#e)})})}},v=s(86290),f=s(87066);async function j(t){let e=await f.Z.get("".concat(l.zA.api_url,"/bodhi/tradelogs"),{params:{address:t}});return e.data.result}let b=t=>{let{data:e,error:s}=(0,u.a)({queryKey:["useTradelogs",t],queryFn:()=>j(t),refetchInterval:6e4});return{tradelogs:e,error:s}};async function Z(t){try{let e=await f.Z.post("".concat(l.zA.api_url,"/bodhi/tradelog-upread"),{id:t});console.log(e.data.message)}catch(t){console.error("Error updating trade log:",t)}}let C=()=>{let t=(0,h.NL)();return function(t,e){let s=(0,h.NL)(void 0),[r]=a.useState(()=>new y(s,t));a.useEffect(()=>{r.setOptions(t)},[r,t]);let n=a.useSyncExternalStore(a.useCallback(t=>r.subscribe(x.V.batchCalls(t)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=a.useCallback((t,e)=>{r.mutate(t,e).catch(v.Z)},[r]);if(n.error&&(0,v.L)(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}({mutationFn:Z,onSuccess:()=>{t.invalidateQueries({queryKey:["useTradelogs"]})}})};var w=s(87952),R=s(11163),k=s(47726),M=s(11288),O=s.n(M),_=s(35553);let I=t=>{let{log:e}=t,s=C(),n=["minted","bought","sold","removed","replied"][e.tradeType],a="sold"==n?"#6d4949":"replied"==n?"#1677af":"#335456",d=(0,R.useRouter)();return(0,r.jsxs)(i.Z,{sx:{backgroundColor:"#312f5c",mt:3,borderRadius:2,padding:"10px",display:"flex",flexDirection:"row",alignItems:"center",gap:4,cursor:"pointer",position:"relative","&:hover":{backgroundColor:"#38366a"}},component:"div",onClick:()=>{s.mutate(e._id),d.push("asset-overview?assetid=".concat("replied"==n?e.parentAssetId:e.assetId))},children:[(0,r.jsx)(w.Z,{sx:{width:"24px",height:"24px"},alt:"",src:O()(e.from)}),(0,r.jsxs)(i.Z,{children:[(0,r.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"row",gap:1,mt:2},children:["minted"==n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"secondary16",color:"text.secondary",children:"You"}),(0,r.jsx)(o.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:"created"}),(0,r.jsx)(o.Z,{variant:"secondary16",color:"text.secondary",children:"your own space."})]}),"replied"==n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"secondary16",color:"text.secondary",children:(0,k.Xe)(e.from,5,0)}),(0,r.jsx)(o.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:n.toUpperCase()}),(0,r.jsxs)(o.Z,{variant:"secondary16",color:"text.secondary",children:["you at #",e.parentAssetId]})]}),("bought"==n||"sold"==n||"removed"==n)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"secondary16",color:"text.secondary",children:(0,k.Xe)(e.from,5,0)}),(0,r.jsx)(o.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:n.toUpperCase()}),(0,r.jsxs)(o.Z,{variant:"secondary16",color:"text.secondary",children:[_.bM(e.tokenAmount,18)," share of your asset #",e.assetId]})]})]}),(0,r.jsx)(o.Z,{variant:"secondary14",color:"text.secondary",sx:{mt:2},children:(0,k.i$)(e.timestamp)})]})]})},E=t=>{let{log:e}=t,s=C(),n=["minted","bought","sold","removed","replied"][e.tradeType],a="sold"==n?"#6d4949":"replied"==n?"#1677af":"#335456",d=(0,R.useRouter)();return(0,r.jsxs)(i.Z,{sx:{backgroundColor:"#312f5c",mt:3,borderRadius:2,padding:"10px",display:"flex",flexDirection:"column",gap:4,cursor:"pointer",position:"relative","&:hover":{backgroundColor:"#38366a"}},component:"div",onClick:()=>{s.mutate(e._id),d.push("asset-overview?assetid=".concat("replied"==n?e.parentAssetId:e.assetId))},children:[(0,r.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"row",gap:2,justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"row",gap:2},children:[(0,r.jsx)(w.Z,{sx:{width:"24px",height:"24px"},alt:"",src:O()(e.from)}),(0,r.jsx)(o.Z,{variant:"secondary16",color:"text.secondary",children:(0,k.Xe)(e.from,5,0)})]}),(0,r.jsx)(o.Z,{variant:"secondary14",color:"text.secondary",sx:{mt:2},children:(0,k.i$)(e.timestamp)})]}),(0,r.jsx)(i.Z,{children:(0,r.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"row",gap:1,mt:2},children:["minted"==n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"secondary16",color:"text.secondary",children:"You"}),(0,r.jsx)(o.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:"created"}),(0,r.jsx)(o.Z,{variant:"secondary16",color:"text.secondary",children:"your own space."})]}),"replied"==n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:n.toUpperCase()}),(0,r.jsxs)(o.Z,{variant:"secondary16",color:"text.secondary",children:["you at #",e.parentAssetId]})]}),("bought"==n||"sold"==n||"removed"==n)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:n.toUpperCase()}),(0,r.jsxs)(o.Z,{variant:"secondary16",color:"text.secondary",children:[_.bM(e.tokenAmount,18)," share of your asset #",e.assetId]})]})]})})]})};function F(){let t=(0,n.Z)("(max-width:980px)"),{currentTimestamp:e,account:s}=(0,c.Yh)(),{tradelogs:a,error:l}=b(null==s?void 0:s.toLowerCase());return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d.Z,{children:(0,r.jsxs)(i.Z,{sx:{display:"flex",flex:1,flexDirection:"column",gap:4},children:[(0,r.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)(o.Z,{variant:"main16",children:"New Message"})}),a?(0,r.jsx)(r.Fragment,{children:a.length>0?(0,r.jsx)(i.Z,{children:t?(0,r.jsx)(r.Fragment,{children:a.map(t=>(0,r.jsx)(E,{log:t},t._id))}):(0,r.jsxs)(r.Fragment,{children:[" ",a.map(t=>(0,r.jsx)(I,{log:t},t._id))]})}):(0,r.jsx)("p",{children:"No trade logs found"})}):(0,r.jsx)("div",{children:"Loading..."})]})})})}}},function(t){t.O(0,[240,266,87,930,170,144,66,952,774,888,179],function(){return t(t.s=4474)}),_N_E=t.O()}]);