"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[258],{7586:function(e,t,n){n.r(t),n.d(t,{BlogEditorModal:function(){return I}});var i=n(5893),s=n(7294),a=n(5616),r=n(9417),l=n(8456),o=n(5861),c=n(1458),d=n(1519),u=n(7066);n(7929);var x=n(8320),h=n(3950),m=n(4032),g=n(6076),f=n(1783),p=n(4187),j=n(2593),b=n(1065),v=n(84),y=n(6172),k=n(888),Z=n(9215),C=n(6770),w=n.n(C),E=n(6164);let S=e=>{let{setContent:t}=e,{quill:n,quillRef:a}=(0,E.p)({theme:"snow",placeholder:"",modules:{toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"}],["link","image"],[{align:[]}],[{color:[]}],["code-block"],["clean"]]},clipboard:{matchVisual:!1}},formats:["bold","italic","underline","strike","align","list","indent","size","header","link","image","video","color","background","clean","code-block"]});(0,s.useEffect)(()=>{n&&(n.on("text-change",(e,i,s)=>{t(n.root.innerHTML)}),n.getModule("toolbar").addHandler("image",l))},[n]);let r=()=>{if(n){let e=n.getContents(),t=e.ops.filter(e=>e.insert&&e.insert.image);return t.length}return 0};function l(){let e=r();if(e>=6){alert("You can only upload a maximum of 6 images.");return}let t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept","image/*"),t.click(),t.onchange=()=>{let e=t.files&&t.files[0];e&&w().imageFileResizer(e,800,800,"JPEG",80,0,e=>{if(n){var t;let i=n.getSelection(!0);n.insertEmbed(null!==(t=null==i?void 0:i.index)&&void 0!==t?t:0,"image",e)}},"base64")}}return(0,i.jsx)("div",{className:"bodhi-editor",children:(0,i.jsx)("div",{ref:a})})},I=()=>{let{refetchBodhiData:e}=(0,Z.n)(),{type:t,close:n}=(0,m.a)(),{signer:C,account:w}=(0,b.Yh)(),[E,I]=(0,s.useState)(""),[M,A]=(0,s.useState)(""),[L,F]=(0,s.useState)(!1),[O,P]=(0,s.useState)(0),[T,W]=(0,s.useState)(0);async function z(){if(P(1),W(0),F(!0),""!==M&&M)setTimeout(()=>{B(M)},500);else try{let e=await u.Z.post(p.zA.api_text,{text:E});200===e.status?(console.log({response:e}),A(e.data.transactionId),B(e.data.transactionId)):((0,v.L)(!1,"Upload failed. Please try again."),F(!1))}catch(e){console.error("Error uploading text:",e),F(!1)}let e=setInterval(()=>{W(e=>Math.min(e+10*Math.random(),100))},100);return()=>{clearInterval(e)}}async function B(t){if(!t||""==t||null==t)return;F(!0);let n=p.TT[p.KY].bodhi,s=new g.CH(n,f,C);try{let a={from:w,to:n,value:j.O$.from(0),data:s.interface.encodeFunctionData("create",[t])},r=await s.provider.estimateGas(a);console.log("gasLimit:",r.toNumber());let l=null==C?void 0:C.sendTransaction({...a,gasLimit:r});null==l||l.then(t=>{t.wait().then(n=>{if(1===n.status){let n=(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Bodhi Asset Posted."}),(0,i.jsxs)("p",{children:["tx:",t.hash]})]});(0,v.V)(!0,n),e&&e(),setTimeout(()=>{R()},500)}else(0,v.L)(!1,"Signature failure.");F(!1)}).catch(e=>{F(!1),(0,v.L)(!1,e.reason)})}).catch(e=>{F(!1),(0,v.L)(!1,e.reason)})}catch(e){F(!1),-32603===e.code&&-32015==e.data.code?(0,v.L)(!1,"Insufficient funds for gas."):(0,v.L)(!1,"Signature failure.")}}function R(){I(""),P(0),A(""),F(!1),n()}return(0,i.jsxs)(i.Fragment,{children:[0==O&&(0,i.jsxs)(x.P,{open:t===m.w.BlogEditor,setOpen:R,contentMaxWidth:720,children:[(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)(h.E,{title:"Create"}),(0,i.jsx)(S,{setContent:I})]}),(0,i.jsx)(a.Z,{sx:{display:"flex",mt:4,justifyContent:"center"},children:(0,i.jsx)(r.Z,{variant:"surface",onClick:()=>{z()},sx:{minWidth:"120px"},disabled:L,startIcon:L&&(0,i.jsx)(l.Z,{size:14}),children:(0,i.jsx)(o.Z,{variant:"buttonM",children:"Post now"})})})]}),1==O&&(0,i.jsxs)(x.P,{open:t===m.w.BlogEditor,setOpen:R,contentMaxWidth:520,children:[(0,i.jsx)(h.E,{title:"Space Preview"}),(0,i.jsx)(a.Z,{sx:{width:"100%"},children:100!=T?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(c.Z,{variant:"determinate",value:T})}):(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsxs)(o.Z,{variant:"main16",sx:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,i.jsx)(k.Z,{sx:{color:"#78e378"}}),(0,i.jsx)(i.Fragment,{children:"Uploaded"})]}),(0,i.jsxs)(o.Z,{variant:"secondary14",color:"text.secondary",children:["Arweave ID: ",M]}),(0,i.jsx)(d.Z,{sx:{mt:2,mb:2}}),(0,i.jsx)(o.Z,{variant:"secondary16",color:"text.primary",children:"Waiting for signing..."})]})}),(0,i.jsxs)(a.Z,{sx:{mt:8,display:"flex",justifyContent:"right",gap:4},children:[(0,i.jsx)(r.Z,{variant:"outlined",onClick:()=>{P(0),F(!1)},sx:{minWidth:"90px"},startIcon:(0,i.jsx)(y.Z,{}),children:(0,i.jsx)(o.Z,{variant:"buttonM",children:(0,i.jsx)(i.Fragment,{children:"Back "})})}),(0,i.jsx)(r.Z,{variant:"surface",onClick:()=>{B(M)},sx:{minWidth:"90px"},disabled:L,startIcon:L&&(0,i.jsx)(l.Z,{size:14}),children:(0,i.jsx)(o.Z,{variant:"buttonM",children:(0,i.jsx)(i.Fragment,{children:L?"Signing":"Sign"})})})]})]})]})}},84:function(e,t,n){n.d(t,{L:function(){return s},V:function(){return a}}),n(7294);var i=n(5678);function s(e,t){e?i.Am.success(t,{autoClose:5e3,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}}):i.Am.error("".concat(t),{autoClose:2500,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}})}function a(e,t){e?i.Am.success(t,{autoClose:5e3,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}}):i.Am.error("".concat(t),{autoClose:2500,position:"top-right",theme:"light",closeOnClick:!0,style:{borderRadius:"6px"}})}}}]);