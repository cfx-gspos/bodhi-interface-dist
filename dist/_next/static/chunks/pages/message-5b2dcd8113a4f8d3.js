(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[728],{4474:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/message",function(){return s(2997)}])},2997:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return E}});var r=s(5893),n=s(5616),i=s(5861),o=s(7294),a=s(9766),u=s(1065),c=s(4187),d=s(8144),l=s(202),h=s(9289),p=s(7037),x=s(7506),m=s(4139),g=class extends x.l{#t;#e=void 0;#s;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,m.VS)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,m.Ym)(e.mutationKey)!==(0,m.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#n(),this.#i(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#i()}mutate(t,e){return this.#r=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#n(){let t=this.#s?.state??(0,h.R)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#i(t){p.V.batch(()=>{if(this.#r&&this.hasListeners()){let e=this.#e.variables,s=this.#e.context;t?.type==="success"?(this.#r.onSuccess?.(t.data,e,s),this.#r.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#r.onError?.(t.error,e,s),this.#r.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#e)})})}},y=s(6290),f=s(7066);async function v(t){let e=await f.Z.get("".concat(c.zA.api_url,"/bodhi/tradelogs"),{params:{address:t}});return e.data.result}let b=t=>{let{data:e,error:s}=(0,d.a)({queryKey:["useTradelogs",t],queryFn:()=>v(t),refetchInterval:6e4});return{tradelogs:e,error:s}};async function j(t){try{let e=await f.Z.post("".concat(c.zA.api_url,"/bodhi/tradelog-upread"),{id:t});console.log(e.data.message)}catch(t){console.error("Error updating trade log:",t)}}let Z=()=>{let t=(0,l.NL)();return function(t,e){let s=(0,l.NL)(void 0),[r]=o.useState(()=>new g(s,t));o.useEffect(()=>{r.setOptions(t)},[r,t]);let n=o.useSyncExternalStore(o.useCallback(t=>r.subscribe(p.V.batchCalls(t)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=o.useCallback((t,e)=>{r.mutate(t,e).catch(y.Z)},[r]);if(n.error&&(0,y.L)(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}({mutationFn:j,onSuccess:()=>{t.invalidateQueries({queryKey:["useTradelogs"]})}})};var C=s(9661),M=s(1163),O=s(7726),w=s(1288),R=s.n(w),_=s(5553);let k=t=>{let{log:e}=t,s=Z(),o=["minted","bought","sold","removed","replied"][e.tradeType],a="sold"==o?"#6d4949":"replied"==o?"#1677af":"#335456",u=(0,M.useRouter)();return(0,r.jsxs)(n.Z,{sx:{backgroundColor:"#312f5c",mt:3,borderRadius:2,padding:"10px",display:"flex",flexDirection:"row",alignItems:"center",gap:4,cursor:"pointer",position:"relative","&:hover":{backgroundColor:"#38366a"}},component:"div",onClick:()=>{s.mutate(e._id),u.push("asset-overview?assetid=".concat("replied"==o?e.parentAssetId:e.assetId))},children:[(0,r.jsx)(C.Z,{sx:{width:"24px",height:"24px"},alt:"",src:R()(e.from)}),(0,r.jsxs)(n.Z,{children:[(0,r.jsxs)(n.Z,{sx:{display:"flex",flexDirection:"row",gap:1,mt:2},children:["minted"==o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{variant:"secondary16",color:"text.secondary",children:"You"}),(0,r.jsx)(i.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:"created"}),(0,r.jsx)(i.Z,{variant:"secondary16",color:"text.secondary",children:"your own space."})]}),"replied"==o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{variant:"secondary16",color:"text.secondary",children:(0,O.Xe)(e.from,5,0)}),(0,r.jsx)(i.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:o.toUpperCase()}),(0,r.jsxs)(i.Z,{variant:"secondary16",color:"text.secondary",children:["you at #",e.parentAssetId]})]}),("bought"==o||"sold"==o||"removed"==o)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{variant:"secondary16",color:"text.secondary",children:(0,O.Xe)(e.from,5,0)}),(0,r.jsx)(i.Z,{variant:"main16",sx:{backgroundColor:a,borderRadius:"2px",padding:"0px 3px"},children:o.toUpperCase()}),(0,r.jsxs)(i.Z,{variant:"secondary16",color:"text.secondary",children:[_.bM(e.tokenAmount,18)," share of your asset #",e.assetId]})]})]}),(0,r.jsx)(i.Z,{variant:"secondary14",color:"text.secondary",sx:{mt:2},children:(0,O.i$)(e.timestamp)})]})]})};function E(){let{currentTimestamp:t,account:e}=(0,u.Yh)(),{tradelogs:s,error:o}=b(null==e?void 0:e.toLowerCase());return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(a.Z,{children:(0,r.jsxs)(n.Z,{sx:{display:"flex",flex:1,flexDirection:"column",gap:4},children:[(0,r.jsx)(n.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)(i.Z,{variant:"main16",children:"New Message"})}),s?(0,r.jsx)(r.Fragment,{children:s.length>0?(0,r.jsx)(n.Z,{children:s.map(t=>(0,r.jsx)(k,{log:t},t._id))}):(0,r.jsx)("p",{children:"No trade logs found"})}):(0,r.jsx)("div",{children:"Loading..."})]})})})}}},function(t){t.O(0,[498,986,395,66,766,774,888,179],function(){return t(t.s=4474)}),_N_E=t.O()}]);